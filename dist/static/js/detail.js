"use strict";function _classCallCheck(i,a){if(!(i instanceof a))throw new TypeError("Cannot call a class as a function")}function _defineProperties(i,a){for(var n=0;n<a.length;n++){var s=a[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,s.key,s)}}function _createClass(i,a,n){return a&&_defineProperties(i.prototype,a),n&&_defineProperties(i,n),i}var uname=location.search.split("=")[1];jQuery.getUrlParam=function(i){var a=new RegExp("(^|&)"+i+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(a);return null!=n?unescape(n[2]):null};uname=$.getUrlParam("uname");$(function(){var i={banners:$(".banner-l"),uname:uname,bid:$.getUrlParam("bid"),cartShopsNum:$("#cartShopsNum")};new showDetailsInfo(i)});var showDetailsInfo=function(){function a(i){_classCallCheck(this,a),this.banners=i.banners,this.uname=i.uname,this.bid=i.bid,this.cartShopsNum=i.cartShopsNum,this.getDetailsphones()}return _createClass(a,[{key:"getDetailsphones",value:function(){var a=this;$.getJSON("json/tianmao.json",function(i){a.showDetailsInfo(i),a.addCart()})}},{key:"showDetailsInfo",value:function(a){for(var n=this.bid,i="",s=0;s<a.length;s++)a[s].bid==this.bid&&(i+='\n        <i style="display:none" class="bid">'.concat(a[s].bid,'</i>\n        <div class="box">\n        <div class="show-image">\n            <img src="images/').concat(a[s].src,'" alt="" style="width: 420px; height: 420px; border: 1px solid #eee;">\n            <span class="filter"></span>\n        </div>\n        <div class="show-big-image">\n            <img src="images/').concat(a[s].src,'" alt="" id="big-image">\n        </div>\n        <ul class="img-box">\n            <li><img src="images/').concat(a[s].src,'" alt=""></li>\n            <li><img src="images/').concat(a[s].src1,'" alt=""></li>\n            <li><img src="images/').concat(a[s].src2,'" alt=""></li>\n            <li><img src="images/').concat(a[s].src3,'" alt=""></li>\n        </ul>\n        <p><span>分享</span>\n            <span><i class="iconfont icon-shoucangxuanzhong"></i>收藏商品&nbsp;（128593人气）</span>\n            <span>举报</span>\n        </p>\n       </div>\n\n       <div class="xinxi">\n          <h2>CONVERSE匡威官方 Chuck Taylor All Star \'70 162063C</h2>\n          <h3>此款鞋尺码偏大 买偏小半码</h3>\n          <div class="price"></div>\n          <h4><span>运费</span> <b>江苏无锡&nbsp;至&nbsp;深圳<i class="iconfont icon-diquxialajiantou"></i>快递：10.00</b></h4>\n          <ul class="pingjia">\n              <li>累计评价<span>6312</span></li>丨\n              <li>送天猫积分<span>269</span></li>\n          </ul>\n          <ul class="title">\n              <li>鞋码</li>\n              <li>颜色分类</li>\n              <li>数量</li>\n          </ul>\n          <ul class="xiema">\n              <li>39</li>\n              <li>39.5</li>\n              <li>40</li>\n              <li>40.5</li>\n              <li>41</li>\n              <li>41.5</li>\n              <li>42</li>\n              <li>42.5</li>\n              <li>43</li>\n              <li>44</li>\n              <li>45</li>\n          </ul>\n          <div class="color">黄色/162063C</div>\n          <div class="count">\n              <input type="text" class="inp" value="1">\n              <button class="btn1"><i class="iconfont icon-sanjiao2"></i></button>\n              <button class="btn2"><i class="iconfont icon-sanjiao1"></i></button>\n          </div>\n          <button class="buy">立即购买</button>\n          <button class="car"><i class="iconfont icon-gouwuche"></i> 加入购物车</button>\n          <p>服务承诺 <b>正品保证</b>\n              <b>极速退款</b>\n              <b>七天无理由退换</b>\n              <b>支付方式 <i class="iconfont icon-diquxialajiantou"></i></b>\n          </p>\n      </div>\n       '));$(".banner-l").html(i);var e=0,t=new Array,l=new Array;$(".banner-l .box .img-box li").click(function(){e=$(this).index();for(var i=0;i<a.length;i++)l.push(a[i].src,a[i].src1,a[i].src2,a[i].src3),t.push(l.splice(0,4));$(".banner-l .box .img-box li").eq(e).addClass("active").siblings().removeClass("active"),101==n?$(".show-image img").attr("src","images/"+t[0][e]):102==n?$(".show-image img").attr("src","images/"+t[1][e]):103==n?$(".show-image img").attr("src","images/"+t[2][e]):104==n?$(".show-image img").attr("src","images/"+t[3][e]):105==n?$(".show-image img").attr("src","images/"+t[4][e]):106==n&&$(".show-image img").attr("src","images/"+t[5][e]),$(".show-image").mouseenter(function(){$(".filter").css("display","block"),$(".show-big-image").css("display","block"),101==n?$("#big-image").attr("src","images/"+t[0][e]):102==n?$("#big-image").attr("src","images/"+t[1][e]):103==n?$("#big-image").attr("src","images/"+t[2][e]):104==n?$("#big-image").attr("src","images/"+t[3][e]):105==n?$("#big-image").attr("src","images/"+t[4][e]):106==n&&$("#big-image").attr("src","images/"+t[5][e])}),$(".show-image").mouseleave(function(){$(".filter").css("display","none"),$(".show-big-image").css("display","none")}),$(".show-image").mousemove(function(i){var a=(i=i||event).pageX-$(".show-image").offset().left-$(".filter").width()/2,n=i.pageY-$(".show-image").offset().top-$(".filter").height()/2,s=$(".show-image").width()-$(".filter").width(),e=$(".show-image").height()-$(".filter").height();a<0?a=0:s<a&&(a=s),n<0?n=0:e<n&&(n=e),$(".filter").css({left:a,top:n});var t=a*$("#big-image").width()/$(".show-image").width(),l=n*$("#big-image").height()/$(".show-image").height();$("#big-image").css({left:-t,top:-l})})})}},{key:"addCart",value:function(){var r=this;this.banners.find(".car").click(function(){var i=$(this).parent().parent().find(".bid").html(),a=[{bid:i,count:1}],n=JSON.stringify(a);if(localStorage.getItem(r.uname+"shops")){for(var s=localStorage.getItem(r.uname+"shops"),e=JSON.parse(s),t=!1,l=0;l<e.length;l++)e[l].bid==i&&(e[l].count++,t=!0);if(!t){var o={bid:i,count:1};e.push(o)}var c=JSON.stringify(e);localStorage.setItem(r.uname+"shops",c)}else localStorage.setItem(r.uname+"shops",n);localStorage.getItem("shops"),r.getCartCount()})}},{key:"getCartCount",value:function(){if(localStorage.getItem(this.uname+"shops")){for(var i=localStorage.getItem(this.uname+"shops"),a=JSON.parse(i),n=0,s=0;s<a.length;s++)n+=a[s].count;this.cartShopsNum.html(n)}}}]),a}();